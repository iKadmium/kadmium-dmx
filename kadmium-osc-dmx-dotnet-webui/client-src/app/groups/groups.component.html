<app-busy-card [loading]="loading" [saving]="saving"></app-busy-card>
<form *ngIf="!loading && !saving" (ngSubmit)="save()" #groupsForm="ngForm">
    <mat-card class="main-card" @slideIn>
        <mat-card-content>
            <table>
                <tr *ngFor="let group of groups; let i = index" @fadeOut>
                    <td>
                        <button mat-icon-button type="button" (click)="swap(i, i - 1)" [disabled]="i == 0" matTooltip="Move Up">
                            <mat-icon label="Move Down">arrow_upward</mat-icon>
                        </button>
                        <button mat-icon-button type="button" (click)="swap(i, i + 1)" [disabled]="i == groups.length - 1" matTooltip="Move Down">
                            <mat-icon label="Move Down">arrow_downward</mat-icon>
                        </button>
                    </td>
                    <td class="groupNameContainer">
                        <mat-form-field class="groupName">
                            <input matInput required [unique]="getOtherGroupNames(group)" type="text" [(ngModel)]="group.name" [name]="'groupName[' + i + ']'"
                                placeholder="Name">
                        </mat-form-field>
                    </td>
                    <td class="actionsCell">
                        <button mat-icon-button color="warn" type="button" (click)="delete(group)">
                            <mat-icon aria-label="Remove">remove_circle</mat-icon>
                        </button>
                    </td>
                </tr>
            </table>

            <button mat-icon-button (click)="add()" type="button" matTooltip="Add Group">
                <mat-icon aria-label="Add Group">add</mat-icon>
            </button>

        </mat-card-content>
        <mat-card-actions>
            <button mat-icon-button color="primary" [disabled]="!groupsForm.valid" type="submit" matTooltip="Save">
                <mat-icon aria-label="Save">save</mat-icon>
            </button>
            <button mat-icon-button type="button" [disabled]="!groupsForm.valid" (click)="download()" matTooltip="Download">
                <mat-icon aria-label="Download">file_download</mat-icon>
            </button>
            <button mat-icon-button type="button" [disabled]="!groupsForm.valid" (click)="upload(fileInput)" matTooltip="Upload">
                <mat-icon aria-label="Upload">file_upload</mat-icon>
            </button>
        </mat-card-actions>
    </mat-card>

</form>

<input #fileInput type="file" name="name" style="display: none;" (change)="filesSelected($event.target.files)" multiple>